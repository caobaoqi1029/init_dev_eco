# Ikun Music

# INFO

| 学号              | 职责                                                       |
| ----------------- | ---------------------------------------------------------- |
| 曹宝琪 2309312102 | 小黑子组长，负责项目管理任务分配，项目打包，文档撰写等工作 |
| 曹蓓 2309312103   | dev，负责动态页面的代码实现                                |
| 王文照 2309312121 | 小黑子                                                     |
| 程柄惠            | dev，负责发现页面代码实现                                  |
| 宋文杰            | 小黑子                                                     |

项目亮点：

- 使用 RDB 操作数据库
- 侧滑删除 music 、自定义播放控件 （可用于控制歌曲前进 | 后退）
- 使用 git 协同开发、通过 vitePress 撰写文档更友好

# 一、整体结构

项目大致分为以下几个页面：

- 推荐页面：展示分类信息
- 发现页面：用于随机音乐推荐 （Random 待实现）
- 音乐页面：主要用于听音乐
- 动态页面：用于展示相关歌曲的评论以及转发点赞等信息

# 二、页面

## 2.1 推荐页面

`RecommendPage` 是一个用于展示音乐推荐内容的页面组件。它包含了搜索区域、轮播图、每日推荐和推荐歌单等模块。

1. **搜索区域 (`searchBuilder`)**
   - 使用 `Row` 布局，包含一个搜索图标、文本和一个二维码图标。
   - 设置背景颜色、边框半径和内边距，以美化界面。
2. **轮播图 (`swiperBuilder`)**
   - 使用 `Swiper` 组件和 `ForEach` 循环来展示多张图片。
   - 设置轮播图的自动播放、循环、间隔时间和指示器样式。
3. **每日推荐 (`titleBuilder` 和 `recommendBuilder`)**
   - 使用 `titleBuilder` 构建标题栏，显示“每日推荐”和“更多...”。
   - 使用 `recommendBuilder` 展示每日推荐的音乐列表，每项包含类型、图片和标题。
   - 使用 `Column` 和 `Row` 布局，以及 `ForEach` 循环来动态生成内容。
4. **推荐歌单 (`titleBuilder` 和 `musicBuider`)**
   - 再次使用 `titleBuilder` 构建标题栏，显示“推荐歌单”和“更多...”。
   - 使用 `musicBuider` 展示推荐歌单，每项包含图片、播放次数和标题。
   - 使用 `Stack` 布局来叠加图片和播放次数，以及 `Column` 和 `Row` 布局来组织内容。

![image-20240607112315754](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240607112315754.png)

## 2.2 发现页面

`FindPage` 是一个用于展示音乐列表并提供播放功能的页面组件。它通过与数据库交互获取音乐列表，并使用 `AvPlayerManager` 来控制音乐的播放和暂停。

1. **初始化 (`aboutToAppear`)**
   - 从数据库中获取音乐列表。
   - 初始化 `AvPlayerManager`，并监听音乐播放的时长和总时长。
2. **音乐列表 (`maybeLikeListBuilder`)**
   - 使用 `List` 和 `ListItem` 组件展示音乐列表。
   - 每个列表项包含音乐封面、音乐名称、作者和播放/暂停按钮。
   - 根据当前播放状态显示不同的播放按钮（播放或暂停）。
   - 支持侧滑操作，侧滑后可以删除音乐。
3. **播放控制**
   - 通过点击播放按钮触发音乐播放，并更新当前播放的音乐和索引。
   - 提供暂停功能，通过点击暂停按钮暂停当前播放的音乐。
4. **状态管理**
   - 使用 `@State` 装饰器管理播放状态 (`isPlaying`)、当前播放索引 (`currentIndex`)、当前播放音乐 (`currentMusic`)、总时长 (`totalTime`) 和当前播放时长 (`currentTime`)。

> [!NOTE]
>
> 关键特性：
>
> - **动态内容生成**：使用 `ForEach` 循环从数据库中动态生成音乐列表。
> - **交互性**：提供播放、暂停和删除音乐的功能。
> - **状态同步**：实时更新播放状态和播放时长，确保用户界面与音乐播放状态同步。

![image-20240607112420953](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240607112420953.png)

> [!CAUTION]
>
> - 使用 RDB 存储操作数据
> - 侧滑删除

## 2.3 音乐页面

`MusicPage` 是一个用于展示音乐播放列表和控制音乐播放的页面组件。它提供了音乐列表的展示、音乐播放控制、播放进度显示以及播放列表的切换功能。

1. **初始化 (`aboutToAppear`)**
   - 初始化 `AvPlayerManager`，并监听音乐播放的时长和总时长。
2. **音乐播放控制 (`MusicPlayBuilder`)**
   - 显示当前播放的音乐名称和作者。
   - 使用 `Image` 组件展示唱片封面，并添加旋转动画。
   - 使用 `Slider` 组件显示和控制播放进度，支持用户拖动滑块调整播放位置。
3. **音乐列表 (`musicListBuilder`)**
   - 使用 `List` 和 `ListItem` 组件展示音乐列表。
   - 每个列表项包含音乐封面、音乐名称、作者和播放/暂停按钮。
   - 根据当前播放状态显示不同的播放按钮（播放或暂停）。
   - 支持侧滑操作，侧滑后可以删除音乐。
4. **播放列表切换**
   - 提供左右切换按钮，允许用户切换到上一首或下一首音乐。

> [!NOTE] 
>
> 关键特性：
>
> - **动态内容生成**：使用 `ForEach` 循环从音乐列表中动态生成音乐列表项。
> - **交互性**：提供播放、暂停、切换音乐和删除音乐的功能。
> - **状态同步**：实时更新播放状态、播放时长和播放列表，确保用户界面与音乐播放状态同步。

![image-20240607112559515](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240607112559515.png)

> [!CAUTION]
>
> - 自定义播放控件
> - 实时渲染当前播放音乐信息

## 2.4 动态页面

`MomentPage` 是一个用于展示音乐互动广场的页面组件。它通过展示用户动态和相关音乐，提供了一个社交互动的平台。用户可以浏览动态、播放音乐、分享和评论。

1. **音乐播放控制 (`playerCardBuilder`)**
   - 在每个动态项中嵌入音乐播放控制卡，显示音乐封面、名称和作者。
   - 根据当前播放状态显示不同的播放按钮（播放或暂停）。
2. **动态列表 (`musicListBuilder`)**
   - 使用 `List` 和 `ListItem` 组件展示动态列表。
   - 每个动态项包含用户头像、作者、内容、音乐播放卡以及分享、评论和点赞的统计信息。
   - 使用 `ForEach` 循环从动态列表中动态生成动态项。

> [!NOTE]
>
> 关键特性：
>
> - **动态内容生成**：使用 `ForEach` 循环从动态列表中动态生成动态项。
> - **交互性**：提供播放音乐的功能，并根据当前播放状态显示不同的播放按钮。
> - **社交互动**：展示动态的分享、评论和点赞统计，增强用户之间的互动。

![image-20240607112740220](https://2024-cbq-1311841992.cos.ap-beijing.myqcloud.com/picgo/image-20240607112740220.png)
